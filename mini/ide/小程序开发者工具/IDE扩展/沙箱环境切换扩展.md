# 简介
沙箱环境可以让开发者在小程序上线到正式环境之前进行调试和测试，不用担心测试数据干扰正式环境，从而安全且轻松地验证支付等关键场景。更多沙箱环境信息可查看 [沙箱环境](https://opendocs.alipay.com/common/02kkv7)。

目前提供 2 种使用方式供开发者选择。
## 1. 使用说明（推荐使用）

- 下载并安装 [小程序开发者工具](https://opendocs.alipay.com/mini/ide/download)（IDE）。
- 安装沙箱支付宝APP10.3.90.8030及以上版本（如果不是，可以去 [沙箱工具](https://auth.alipay.com/login/ant_sso_index.htm?goto=https%3A%2F%2Fopen.alipay.com%2Fdevelop%2Fsandbox%2Ftool)下载）

最新的沙箱小程序预览/真机调试方案，已经不再依赖沙箱环境切换插件，解决了环境切换后 IDE 重启的痛苦。欢迎大家参考 [IDE支持的差异](https://opendocs.alipay.com/common/02kkv7#IDE%E6%94%AF%E6%8C%81%E7%9A%84%E5%B7%AE%E5%BC%82) 进行使用。
## 2. 使用说明

- 下载并安装 [小程序开发者工具](https://opendocs.alipay.com/mini/ide/download)（IDE）。
- 支持 IDE 0.70 及以上版本。

### 使用步骤

#### 新建小程序支付 demo 项目

1. 启动 IDE，选择 **小程序** > **添加项目** > **选择端** > **选择模板** > **云与开放能力** > **小程序支付**，点击 **下一步**。<br /> ![|900x340](https://cdn.nlark.com/yuque/0/2022/png/179989/1651138716825-dacd8019-ab6b-471d-9a48-daf9752b9a67.png)

2. 点击 **完成**，完成基于 **小程序支付** 模板创建小程序项目。<br /> ![|900x340](https://mdn.alipayobjects.com/afts/img/A*jU7RQIskDf4AAAAAAAAAAAAAAa8wAA/original?bz=openpt_doc&t=Nkcep743sIr6al8RivGSigAAAABkMK8AAAAA#align=left&display=inline&height=700&margin=%5Bobject%20Object%5D&originHeight=700&originWidth=1000&status=done&style=none&width=1000)

#### 安装沙箱环境切换插件、切换到沙箱环境

1. 在左侧功能面板，点击 **扩展市场** 图标，选择 **沙箱环境切换扩展** 并点击 **安装** 按钮。<br /> ![|900x340](https://gw.alipayobjects.com/zos/skylark-tools/public/files/5f628fcee69ad6932788ec543b9c5a90.png#align=left&display=inline&height=342&margin=%5Bobject%20Object%5D&originHeight=679&originWidth=1156&status=done&style=none&width=582)

1. 安装完成后，点击 **启用**。<br /> ![|900x350](https://gw.alipayobjects.com/mdn/rms_d52ffc/afts/img/A*VkzBQ6wplCAAAAAAAAAAAABkARQnAQ#align=left&display=inline&height=134&margin=%5Bobject%20Object%5D&originHeight=217&originWidth=940&status=done&style=none&width=581)

1. 启用插件后，在 IDE 左上角，点击 **正式环境** 下拉框，选择 **沙箱环境(新)**，切换到新沙箱环境。<br /> ![|900x340](https://github.com/AlipayDocs/open-docs/assets/125548570/1322a47f-bb9f-4680-b38f-30aadce22fb9)<br /> ![|900x340](https://github.com/AlipayDocs/open-docs/assets/125548570/b34544ba-ed18-4e2f-9fa4-f7c335135d5b)

#### 使用沙箱版支付宝客户端扫码登录

1. 下载沙箱版支付宝客户端并使用沙箱账号登录。详情可查看 [小程序沙箱接入](https://openhome.alipay.com/platform/sandboxMini.htm)。

1. 在 IDE 工具栏右侧，点击 **登录** 按钮，弹出登录二维码。 

3. 使用沙箱版支付宝扫码，**确认授权**，成功登录沙箱环境。<br /> ![|250x340](https://github.com/AlipayDocs/open-docs/assets/125548570/802d764d-10ed-4888-82c1-8e1035837c33)

1. 使用使用沙箱环境的商家账号，登录新版本的沙箱支付宝 App 后，扫描上面的登录二维码，确认授权，成功登录沙箱环境。说明：登录成功后的跳转页面出现 404 是由于跳转的开发者助手小程序没有入驻沙箱导致，不影响 IDE 侧的功能。<br /> ![|500x340](https://github.com/AlipayDocs/open-docs/assets/125548570/2e32ccdd-eeb1-47c4-bf2d-88cd264850da)
  
#### 小程序支付 Demo

可查看 [小程序支付](https://opendocs.alipay.com/mini/quick-example/payment) 快速示例中的 [后端开发](https://opendocs.alipay.com/mini/quick-example/payment#后端开发)、[数据准备](https://opendocs.alipay.com/mini/quick-example/payment#数据准备)、[前端配置](https://opendocs.alipay.com/mini/quick-example/payment#前端配置) 相关内容，完成开发步骤。

**注意**：需要将后端开发中的以下内容替换为沙箱对应的 **应用私钥**、**支付宝公钥**、**APPID**。

```javascript
#应用的私钥，需要保管好，应用的公钥存储在支付宝服务端
alipay.appconfig.privatekey=
#支付宝提供给这个应用的公钥，私钥存储在支付宝服务端中
alipay.appconfig.publickey=
#开放平台申请应用的Id
alipay.appconfig.appid=
```

#### 运行 demo 体验小程序支付

点击 **预览** 按钮，即生成二维码，使用沙箱版支付宝客户端扫码即可体验 demo。
![|900x500](https://github.com/AlipayDocs/open-docs/assets/125548570/da09779a-dccd-4c5d-8ac0-55ff0ce3ff07)
