# 文件结构

小程序分为 `app` 和 `page` 两层。`app` 用来描述整个应用，而 `page` 用来描述各个页面。此外，还有关于整个 `project` 的配置描述（可选）。

`app` 由三个文件组成，必须放在项目的根目录。

| 文件   | 必填 | 作用           |
| ------ | ---- | -------------- |
| app.js | 是   | 小程序逻辑     |
| app.json | 是   | 小程序全局设置 |
| app.acss | 否   | 小程序全局样式表 |

`page` 由四个文件组成，分别是：

| 文件类型 | 必填 | 作用         |
| -------- | ---- | ------------ |
| js       | 是   | 页面逻辑     |
| axml     | 是   | 页面结构     |
| json     | 是   | 页面配置     |
| acss     | 否   | 页面样式表   |

**注意：** 为了方便开发者，支付宝小程序规定这四个文件必须具有相同的路径与文件名。`project` 特指 `mini.project.json` 文件，须放在项目的根目录。其中的具体配置可以查看 [小程序项目配置介绍](https://opendocs.alipay.com/mini/framework/project)。开发者编写的所有代码最终会打包成一份 JavaScript 脚本。在小程序启动时运行，结束运行时销毁。
# 逻辑结构

小程序的核心是一个响应式的数据绑定系统，分为视图层和逻辑层。这两层始终保持同步，只要在逻辑层修改数据，视图层就会相应地更新。示例代码：

```html
<!-- 视图层 -->
<view> Hello {{name}}! </view>
<button onTap="changeName">Click me!</button>
```

```javascript
// 逻辑层
var initialData = {
  name: 'taobao',
};
// 注册一个页面
Page({
  data: initialData,
  changeName(e) {
    // 改变数据
    this.setData({
      name: 'alipay',
    });
  },
});
```

如上代码所示，框架自动将逻辑层数据中的 `name` 与视图层的 `name` 进行了绑定，因此页面一打开的时候会显示 `Hello taobao!`。用户点击按钮时，视图层会发送 `changeName` 的事件给逻辑层，逻辑层找到对应的事件处理函数。执行 `setData` 操作后，将 `name` 从 `taobao` 变为 `alipay`，由于该数据和视图层已经绑定，视图层会自动更新为 `Hello alipay!`。**注意：** 由于框架并非运行在浏览器中，因此 JavaScript 在 web 中的一些能力都无法使用，例如 `document`、`window` 等对象。逻辑层的 JavaScript 可以使用 ES2015 的模块化语法组织代码：

```javascript
import util from './util'; // 载入相对路径
import absolute from '/absolute'; // 载入项目根路径文件
```
## 模块名的保留字

小程序中将一些浏览器内部对象名（如 `window`、`document`）定义为保留字，为未来的应用留出可能性。这些保留字包括：`globalThis`、`global`、`AlipayJSBridge`、`fetch`、`self`、`window`、`document`、`location`、`XMLHttpRequest`。请不要使用这些保留字作为模块名，否则可能会导致框架无法正常访问模块。例如：

```javascript
import { window } from './myWindow';
console.log(window); // 结果为 undefined
```

在上述代码中，由于模块名采用了保留字，导致引入的模块变成了 `undefined`。正确的做法是避免使用保留字命名模块。或者，在引入模块时，可以使用 `as` 关键字给模块重新命名。例如：

```javascript
import { window as myWindow } from './myWindow';
console.log(myWindow);
```

## 第三方 NPM 模块

小程序支持引入第三方模块。首先，需要在小程序的根目录下执行以下命令来安装所需模块：

```shell
$ npm install query-string --save
```

安装完成后，即可在逻辑层中直接使用该模块：

```javascript
import queryString from 'query-string'; // 引入第三方 npm 模块
```

关于 NPM 的详细介绍，请参阅 [NPM 包管理](https://opendocs.alipay.com/mini/ide/npm-manage)。

**注意**：由于 `node_modules` 中的第三方模块代码不会经过转换器处理，为了确保各终端的兼容性，`node_modules` 下的代码需要转换为 ES5 格式后引用。同时，推荐模块格式使用 ES2015 的 import/export 语法。此外，无法使用浏览器相关的 web 能力。
