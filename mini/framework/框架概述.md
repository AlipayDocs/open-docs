# 文件结构

小程序分为 `app` 和 `page` 两层结构。`app` 描述整个应用程序，而 `page` 描述各个独立页面。此外，还有描述整个 `project` 的配置（可选项）。

`app` 由以下三个文件组成，这些文件必须放置在项目的根目录中：

| **文件** | **必填** | **作用**         |
| -------- | -------- | ---------------- |
| app.js   | 是       | 小程序逻辑       |
| app.json | 是       | 小程序全局设置   |
| app.acss | 否       | 小程序全局样式表 |

每个 `page` 由四个文件组成，具体如下：

| **文件类型** | **必填** | **作用**   |
| ------------ | -------- | ---------- |
| .js          | 是       | 页面逻辑   |
| .axml        | 是       | 页面结构   |
| .json        | 是       | 页面配置   |
| .acss        | 否       | 页面样式表 |

**注意**：为了便于开发者管理，支付宝小程序要求这四个文件必须具有相同的路径和文件名。关于 `project` 的配置，指的是 `mini.project.json` 文件，它也必须放在项目的根目录。你可以在[小程序项目配置介绍](https://opendocs.alipay.com/mini/framework/project)中查看具体的配置选项。所有开发者编写的代码最终将打包成一个 JavaScript 脚本，在小程序启动时运行，并在小程序结束时销毁。

# 逻辑结构

小程序的核心功能是响应式数据绑定，它由视图层和逻辑层组成。这两层保持实时同步，当逻辑层的数据变化时，视图层会自动更新以反映这些变化。下面是一个典型的示例：

```html
<!-- 视图层 -->
<view> Hello {{name}}! </view>
<button onTap="changeName">Click me!</button>
```

```javascript
// 逻辑层
var initialData = {
  name: 'taobao',
};
// 页面注册
Page({
  data: initialData,
  changeName(e) {
    // 更新数据
    this.setData({
      name: 'alipay',
    });
  },
});
```

在这段代码中，当页面初次加载时，用户会看到文本 `Hello taobao!`。当用户点击按钮时，视图层触发 `changeName` 事件，逻辑层响应并执行 `setData` 方法来更新数据。由于 `name` 已与视图层绑定，数据变更后视图层自动更新文本为 `Hello alipay!`。

**注意**：小程序不在传统的浏览器环境下运行，因此无法使用某些 Web 特有的 JavaScript 对象，比如 `document` 和 `window`。在逻辑层，你可以使用 ES2015 的模块化语法来组织代码，这有助于提高项目的结构化和代码的可维护性：

```javascript
import util from './util'; // 导入模块，使用相对路径
import absolute from '/absolute'; // 导入模块，使用项目根路径
```

## 模块名的保留字

在小程序中，某些浏览器内置对象的名称（如 `window`、`document`）被作为保留字使用，以备将来可能的需求。以下是保留字列表：

- **globalThis**
- **global**
- **AlipayJSBridge**
- **fetch**
- **self**
- **window**
- **document**
- **location**
- **XMLHttpRequest**

请避免使用这些保留字作为模块名，否则可能导致无法正常访问模块。例如：

```javascript
import { window } from './myWindow';
console.log(window); // 结果为 undefined
```

正确的做法是避免使用保留字命名模块，因为在小程序的 JavaScript 环境中，这些保留字可能与系统内置对象或功能关联，使用它们作为模块名可能会导致冲突，从而使得模块无法被正确引用。如果确实需要使用这些名称，可以通过 `as` 关键字在引入时给模块重新命名，这样可以避免潜在的命名冲突。例如：

```javascript
import { window as myWindow } from './myWindow';
console.log(myWindow); // 正确显示模块内容
```

在上述代码中，通过 `as` 关键字将 `window` 模块重命名为 `myWindow`，这样就可以避免与小程序环境中的 `window` 保留字冲突，并且能够正确地引用和使用模块。

# 第三方 NPM 模块

小程序支持引入第三方 NPM 模块。要安装第三方模块，请在小程序根目录下执行以下命令：

```bash
npm install query-string --save
```

安装完成后，你可以在逻辑层中直接使用该模块：

```javascript
import queryString from 'query-string'; // 导入第三方 NPM 模块
```

更多关于 NPM 的信息，请参阅[小程序 NPM 包管理](https://opendocs.alipay.com/mini/ide/npm-manage)文档。

**注意**：由于 `node_modules` 目录下的第三方模块代码不会经过转换器处理，为确保各终端的兼容性，建议将 `node_modules` 下的代码转换为 ES5 格式后再引用。同时，推荐使用 ES2015 的 `import/export` 模块格式。另外，由于小程序不运行在浏览器环境中，浏览器相关的 Web 能力无法使用。